name: Deploy to Polygon mainnet

on:
  workflow_dispatch:

env:
  POLYGONSCAN_KEY: ${{secrets.POLYGONSCAN_KEY}}
  PRIVATE_KEY_DEV: ${{secrets.PRIVATE_KEY_DEV}}
  PRIVATE_KEY_PROD: ${{secrets.PRIVATE_KEY_PROD}}
  ALCHEMY_URL: ${{secrets.ALCHEMY_URL}}

jobs:
  deploy_to_polygon:
    if: contains('["shanzid01"]', github.actor)
    runs-on: ubuntu-latest
    env:
      TOKEN_NAME: ${{ github.event.inputs.TOKEN_NAME }}
      TOKEN_SYMBOL: ${{ github.event.inputs.TOKEN_SYMBOL }}
      MAX_SUPPLY: ${{ github.event.inputs.MAX_SUPPLY }}
      MINT_COMMISSION: ${{ github.event.inputs.MINT_COMMISSION }}
    steps:
      - uses: actions/checkout@v2
      - uses: actions/setup-node@v1
        with:
          node-version: 14
      - run: npm ci
      - run: npx hardhat compile
      - run: npx hardhat deploy --network matic_prod
  